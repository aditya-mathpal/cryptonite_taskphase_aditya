# format string 0
The source code shows that the flag is printed when a segfault occurs.  
The first user input that the program takes is an unsanitized string using `scanf()`, so test this by inputting a long string `aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa`.  
The flag is printed to the terminal.

# format string 1
As per the source code, the flag is not directly printed by the program under any circumstance. The vulnerability lies in this piece of code:
```
scanf("%1024s", buf);
printf("Here's your order: ");
printf(buf);
```
Before anything is printed to the terminal, the `main()` function first initialised three strings, the second one of which is the flag:  
```
fd = fopen("flag.txt", "r");
if (fd == NULL){
printf("'flag.txt' file not found, aborting.\n");
return 1;
}
fgets(flag, 64, fd);
```

The hints for the challenge include a pdf and a question asking whether the binary is 32- or 64-bit.  
Using the `file` command we can determine that the binary is 64 bit.  
That pdf, which explains format strings and potential vulerabilities and attacks in detail, talks about stack reads, how the very vulnerability pointed out can be used to read the process stack. Right before anything is output to the terminal, `secret2` is initialized, and right before that `flag` is initialized.  

So now as per the text, `%lx`, a format specifier that formats long ints as hexadecimal numbers, can be used to print the stack, first 5 of them will print the contents of 5 registers, owing to the fact that the binary is 64-bit, and then it'll start printing the stack contents.  
Spam a bunch of `%lx` into the terminal, copy the output and paste it into a hexadecimal to ASCII converter.  
The output seems to be gibberish, so take off the first character as a trial.  
Some plaintext that looks reminiscent to a flag is revealed: `{FTCocip5_14m1n44x4_31y71e_g41f_}8108e1`  
It can be observed that this is the flag with every set of 8 contiguous characters reversed, probably printed this way because of the way it's stored on the stack or possibly some endian conflict.  
Separate every 8 successive characters, reverse each set individually, and that gets us the flag.

# format string 2
